---
title: "midterm project team 5"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ezids)
library(dplyr)
library(readr)
library(tidyr)
library(knitr)
library(magrittr)
```


# Research Topic  
Our research topic is **Trend of Major Types of Crimes commited by White Males in the DC Area in 2016-2021**. We chose this topic because we are interested in the impact of COVID-19 on crimes. We will use [the data provided by the Metropolitan Police of DC](https://mpdc.dc.gov/node/1379551) regarding adult arrests over a time period stretching between 2016-2021.

# Data Shaping
## Read Data
We read the data .CSV files of adults arrest in DC area from 2016-2021

```{r }
df_2016<-data.frame(read.csv("Arrests 2016 Public.csv"))
df_2017<-data.frame(read.csv("Arrests 2017 Public.csv"))
df_2018<-data.frame(read.csv("Arrests by Year, 2018.csv"))
df_2019<-data.frame(read.csv("Arrests by Year, 2019.csv"))
df_2020<-data.frame(read.csv("Arrests by Year 2020.csv"))
df_2021<-data.frame(read.csv("2021 Adult Arrests.csv"))

c16 <- c(colnames(df_2016))
c18 <- c(colnames(df_2018))
```

The column names of the data in 2016 and 2017 were not the same with others. The below table shows the column names of the data in 2016 and the data in 2016.

|col #|2016       |2018       |
|:---:|:---------:|:---------:|
|  1  |`r c16[1]` |`r c18[1]` |
|  2  |`r c16[2]` |`r c18[2]` |
|  3  |`r c16[3]` |`r c18[3]` |
|  4  |`r c16[4]` |`r c18[4]` |
|  5  |`r c16[5]` |`r c18[5]` |
|  6  |`r c16[6]` |`r c18[6]` |
|  7  |`r c16[7]` |`r c18[7]` |
|  8  |`r c16[8]` |`r c18[8]` |
|  9  |`r c16[9]` |`r c18[9]` |
| 10  |`r c16[10]`|`r c18[10]`|
| 11  |`r c16[11]`|`r c18[11]`|
| 12  |`r c16[12]`|`r c18[12]`|
| 13  |`r c16[13]`|`r c18[13]`|
| 14  |`r c16[14]`|`r c18[14]`|
| 15  |`r c16[15]`|`r c18[15]`|
| 16  |`r c16[16]`|`r c18[16]`|
| 17  |`r c16[17]`|`r c18[17]`|
| 18  |`r c16[18]`|`r c18[18]`|
| 19  |`r c16[19]`|`r c18[19]`|
| 20  |`r c16[20]`|`r c18[20]`|
| 21  |`r c16[21]`|`r c18[21]`|
| 22  |`r c16[22]`|`r c18[22]`|
| 23  |`r c16[23]`|`r c18[23]`|
| 24  |`r c16[24]`|`r c18[24]`|
| 25  |`r c16[25]`|`r c18[25]`|
| 26  |`r c16[26]`|`r c18[26]`|


## Merge Multiple CSV Files and Drop Some Columns  
The column names were same from the first column to the 14th column in both data. On the other hand, the name and order of 15th and latter columns were a bit different in those data. The latter columns were about locations, and we were not very interested in the detail location. Therefore, we deleted the latter columns except for the 16th and 22nd columns. In addition, we dropped `CNN` (col #5) and `Arrest.Number.` (col #6) because they were IDs and useless for our analysis.
  
The format of date was different from years; the data in 2016 and 2017 has the format like `r df_2016$Arrest.Date[1]`, the data in 2018 to 2020 has the format like `r df_2018$Arrest.Date[1]`, and the data in 2021 has the format like `r df_2021$Arrest.Date[1]`. We coverted Since different date formats for different years are difficult to analyze, we will unify the date format to "yyyy-mm-dd".
  
After deleting some columns and changing the date format, we binded data frames by rows.


```{r}
# convert format
df_2018$Arrest.Date <- as.Date(df_2018$Arrest.Date, format = "%m/%d/%Y") %>% format()
df_2019$Arrest.Date <- as.Date(df_2019$Arrest.Date, format = "%m/%d/%Y") %>% format()
df_2020$Arrest.Date <- as.Date(df_2020$Arrest.Date, format = "%m/%d/%Y") %>% format()
df_2021$Arrest.Date <- as.Date(df_2021$Arrest.Date, format = "%Y/%m/%d") %>% format()

#bind df_2016 and df_2017, and delete some columns
df_16_17 <- rbind(df_2016, df_2017)[,-c(5,6,15,17:21,23:26)]
names(df_16_17)[c(13,14)] <- c('Arrest.Location.District','Offense.Location.District')   #rename columns

#bind df_2018 - df_2021, and delete some columns
df_18_21 <- rbind(df_2018, df_2019, df_2020, df_2021)[,-c(5,6,15,17:21,23:26)] 

DF<-rbind(df_16_17,df_18_21)
```

  
## Correct Anomalies   
### Remove abnormal values  
To see whether there were abnormal values, we created the table showing some statistics for numerical variables.

```{r}
xkablesummary(subset(DF,select=c(Arrest.Year, Arrest.Hour, Age)))
```

The maximum age was too old. `r nrow(DF[DF$Age>=100,])` rows were assigned an age of over 100 years (`r min(DF[DF$Age>=100,]$Age)`-`r max(DF[DF$Age>=100,]$Age)` ) in these data, and it seemed to be wrong. Therefore, we dropped these rows.  

```{r}
DF <- DF[!DF$Age>=100,]
```


### Correct inconsistent values    
`Arrest.Category` had some different values for 2021 and other years:  

* Data in 2021 had "Release Violations/Fugitive (Fug)" and "Release Violations/Fugitive (Warr)" although data in other years have "Release Violations/Fugitive" instead of them.  
* Data in 2021 had "Fraud and Financial Crimes (Frau)" although data in other years have "Fraud and Financial Crimes".  

Therefore, we coverted these values in 2021 into the correspond values in other years.  


```{r}
DF <- mutate(DF, Arrest.Category = gsub(Arrest.Category, pattern = "Release Violations/Fugitive.*", replacement = "Release Violations/Fugitive"))
DF <- mutate(DF, Arrest.Category = gsub(Arrest.Category, pattern = "Fraud and Financial Crimes.*", replacement = "Fraud and Financial Crimes"))
```

## Remove Unnecessary Rows  
Since we were interested in crimes committed by while males, we dropped rows where the value of `Defendant.Race` was not "White". The structure of the final data is shown in the below table.

```{r}
DF_WM <- subset(DF, subset = Defendant.Race=='WHITE' & Defendant.Sex=='MALE')

data.frame(column_name = names(DF_WM),
           class = sapply(DF_WM, typeof),
           first_values = sapply(DF_WM, function(x) paste0(head(x),  collapse = ", ")),
           row.names = NULL) %>% 
  kable("simple", caption = 'Data frame structure')
```


# EDA

The number of crimes is as follows. Crime occurrences have decreased after COVID-19.

| year | the number of crimes |
|:-----|:---------------------|
| 2016 | `r nrow(subset(DF_WM, Arrest.Year==2016))` |
| 2017 | `r nrow(subset(DF_WM, Arrest.Year==2017))` |
| 2018 | `r nrow(subset(DF_WM, Arrest.Year==2018))` |
| 2019 | `r nrow(subset(DF_WM, Arrest.Year==2019))` |
| 2020 | `r nrow(subset(DF_WM, Arrest.Year==2020))` |
| 2021 | `r nrow(subset(DF_WM, Arrest.Year==2021))` |
| 2016 - 2019 (before COVID-19) | `r round(nrow(subset(DF_WM, Arrest.Year==2016 | Arrest.Year==2017 | Arrest.Year==2018 | Arrest.Year==2019)) / 4)` |
| 2020 - 2021 (after COVID-19) | `r round(nrow(subset(DF_WM, Arrest.Year==2020 | Arrest.Year==2021)) / 2)`|

## Number of Each Crime
We created some bar plots to see the number of occurrences per type of crime.  
The Bar plot of crimes in 2016 - 2021 is as follows:
```{r}

ggplot(DF_WM, aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 1: Bar plot of crimes in 2016 - 2021") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

The Bar plots of crimes before COVID-19 (2016 - 2019) and after COVID-19 (2020 -  2021) are as follows:
```{r, fig.show="hold", out.width="48%"}

ggplot(subset(DF_WM,Arrest.Year <= 2019), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 2: Bar plot of crimes befor COVID-19") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year > 2019), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 3: Bar plot of crimes after COVID-19") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

The Bar plots of crimes in each year are as follows:

```{r, fig.show="hold", out.width="48%"}

ggplot(subset(DF_WM,Arrest.Year == 2016), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 4: Bar plot of crimes in 2016") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year == 2017), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 5: Bar plot of crimes in 2017") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year == 2018), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 6: Bar plot of crimes in 2018") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year == 2019), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 7: Bar plot of crimes in 2019") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year == 2020), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 8: Bar plot of crimes in 2020") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

ggplot(subset(DF_WM,Arrest.Year == 2021), aes(forcats::fct_infreq(Arrest.Category))) +
  ggtitle("Figure 9: Bar plot of crimes in 2021") + xlab("crime types") + geom_bar() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```

"Offenses Against Family & Children" have been increasing after COVD-19.

```{r}
cnt_2016 <- table(subset(DF_WM,Arrest.Year==2016)$Arrest.Category)
pos_2016 <- order(cnt_2016, decreasing = TRUE)[1:6]
crime_2016 <- names(cnt_2016)[pos_2016]

cnt_2017 <- table(subset(DF_WM,Arrest.Year==2017)$Arrest.Category)
pos_2017 <- order(cnt_2017, decreasing = TRUE)[1:7]
crime_2017 <- names(cnt_2017)[pos_2017]

cnt_2018 <- table(subset(DF_WM,Arrest.Year==2018)$Arrest.Category)
pos_2018 <- order(cnt_2018, decreasing = TRUE)[1:6]
crime_2018 <- names(cnt_2018)[pos_2018]

cnt_2019 <- table(subset(DF_WM,Arrest.Year==2019)$Arrest.Category)
pos_2019 <- order(cnt_2019, decreasing = TRUE)[1:7]
crime_2019 <- names(cnt_2019)[pos_2019]

cnt_2020 <- table(subset(DF_WM,Arrest.Year==2020)$Arrest.Category)
pos_2020 <- order(cnt_2020, decreasing = TRUE)[1:7]
crime_2020 <- names(cnt_2020)[pos_2020]

cnt_2021 <- table(subset(DF_WM,Arrest.Year==2021)$Arrest.Category)
pos_2021 <- order(cnt_2021, decreasing = TRUE)[1:7]
crime_2021 <- names(cnt_2021)[pos_2021]
```
The top 6 crimes (or 7 crimes when 'Other Crimes' are included) in each year are as follows.  

| Rank | 2016 | 2017 | 2018 | 2019 | 2020 | 2021 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|`r crime_2016[1]`|`r crime_2017[1]`|`r crime_2018[1]`|`r crime_2019[1]`|`r crime_2020[1]`|`r crime_2021[1]`|
|2|`r crime_2016[2]`|`r crime_2017[2]`|`r crime_2018[2]`|`r crime_2019[2]`|`r crime_2020[2]`|`r crime_2021[2]`|
|3|`r crime_2016[3]`|`r crime_2017[3]`|`r crime_2018[3]`|`r crime_2019[3]`|`r crime_2020[3]`|`r crime_2021[3]`|
|4|`r crime_2016[4]`|`r crime_2017[4]`|`r crime_2018[4]`|`r crime_2019[4]`|`r crime_2020[4]`|`r crime_2021[4]`|
|5|`r crime_2016[5]`|`r crime_2017[5]`|`r crime_2018[5]`|`r crime_2019[5]`|`r crime_2020[5]`|`r crime_2021[5]`|
|6|`r crime_2016[6]`|`r crime_2017[6]`|`r crime_2018[6]`|`r crime_2019[6]`|`r crime_2020[6]`|`r crime_2021[6]`|
|7|`r crime_2016[7]`|`r crime_2017[7]`|`r crime_2018[7]`|`r crime_2019[7]`|`r crime_2020[7]`|`r crime_2021[7]`|


## Time Series Change in the Number of Major Crimes
To see the trend of the above major crimes, we created a line plot as follows.

```{r}
SA_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Simple Assault',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Simple Assault',]$Arrest.Year==x)})
TV_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Traffic Violations',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Traffic Violations',]$Arrest.Year==x)})
RV_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Release Violations/Fugitive',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Release Violations/Fugitive',]$Arrest.Year==x)})
DI_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Driving/Boating While Intoxicated',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Driving/Boating While Intoxicated',]$Arrest.Year==x)})
N_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Narcotics',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Narcotics',]$Arrest.Year==x)})
LV_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Liquor Law Violations',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Liquor Law Violations',]$Arrest.Year==x)})
T_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Theft',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Theft',]$Arrest.Year==x)})
DV_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Offenses Against Family & Children',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Offenses Against Family & Children',]$Arrest.Year==x)})
DC_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Disorderly Conduct',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Disorderly Conduct',]$Arrest.Year==x)})
P_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Prostitution',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Prostitution',]$Arrest.Year==x)})
DP_cnt <- sapply(unique(DF_WM[DF_WM$Arrest.Category=='Damage to Property',]$Arrest.Year),
                       function(x){sum(DF_WM[DF_WM$Arrest.Category=='Damage to Property',]$Arrest.Year==x)})
year_lst <- 2016:2021

major_crimes_df <- data.frame(year_lst, SA_cnt, TV_cnt, RV_cnt, DI_cnt, N_cnt, LV_cnt, T_cnt, DV_cnt, DC_cnt, P_cnt, DP_cnt)

colnames(major_crimes_df) <- c('Year', 'Simple Assault', 'Traffic Violations', 'Release Violations/Fugitive', 'Driving/Boating While Intoxicated',
                               'Narcotics', 'Liquor Law Violations', 'Theft', 'Offenses Against Family & Children', 'Disorderly Conduct', 'Prostitution', 'Damage to Property')

major_crimes_df2 <- major_crimes_df %>% gather(key = 'Crimes', value = "Count", -Year)

ggplot(data=major_crimes_df2, aes(x=Year, y=Count, color=Crimes)) +
  geom_line() + geom_point()

```
  
**"Simple Assault"**, **"Traffic Violations"**, and **"Theft"** have clearly declined since 2020. On the other, **"Offenses Against Family & Children"** has increased in 2020 and 2021 compared to previous years. COVID-19 seems to be related to these trend change. We posed the following SMART QUESTION, and we will analyze these four crimes in detail in the following.  
  
**Is there a significant difference in "Simple Assault", "Traffic Violations", "Theft", and "Offenses Against Family & Children" trends among adult white males within the DC area between 2016 and 2021, and could COVID protocols play a role in these trend shifts?**


```{r, include=FALSE}
#  table of the number of each crime type in each year
table_freq <- xtabs(~Arrest.Year+Arrest.Category,DF_WM)

# total number of crimes in each year
sum16 <- sum(table_freq[1,])
sum17 <- sum(table_freq[2,])
sum18 <- sum(table_freq[3,])
sum19 <- sum(table_freq[4,])
sum20 <- sum(table_freq[5,])
sum21 <- sum(table_freq[6,])
sum_lst <- c(sum16,sum17,sum18,sum19,sum20,sum21)

# table of the percentage of crimes in each year
table_rfreq <- table_freq/sum_lst

# convert table_rfreq into dataframe
DF_rfreq <- data.frame(table_rfreq)

# convert the data type of 'Arrest.Year' from factor into numeric
DF_rfreq$Arrest.Year <- as.character(DF_rfreq$Arrest.Year) %>% as.numeric()

```


```{r, include=FALSE}

ggplot(DF_rfreq, aes(x=Arrest.Year, y=Freq, color=Arrest.Category, group=Arrest.Category)) +
  ggtitle("Figure 10: Line plot of percentage of a crime vs year") + xlab("Year") + 
  ylab("Percentage of a crime relative to all crimes") +
  geom_line() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1), 
        legend.text = element_text(size=5),
        legend.key.size = unit(0.2, 'cm')) 
```


```{r, include=FALSE}
#install.packages("ggrepel") 
library(ggrepel)

# list of Arrest.Category sorted by descending order
tmp <- DF_rfreq[DF_rfreq$Arrest.Year==2021,]
tmp <- tmp$Arrest.Category[order(-tmp$Freq)]
tmp <- as.character(tmp) 

DF_rfreq_10 <- subset(DF_rfreq, Arrest.Category %in% tmp[c(1:10)])

ggplot(DF_rfreq_10, aes(x=Arrest.Year, y=Freq, color=Arrest.Category, group=Arrest.Category)) +
  ggtitle("Figure 11: Line plot of percentage of a crime vs year for top 10 crimes in 2021") + 
  xlab("Year") + 
  ylab("Percentage of a crime relative to all crimes") +
  geom_line() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = "none") +
  geom_text_repel(
    data = subset(DF_rfreq_10, Arrest.Year == 2021),
    aes(label = Arrest.Category),
    nudge_x = 1,
    nudge_y = 0.08,
    segment.alpha = 0.3,
    size = 2
  ) +
  lims(x = c(2016, 2023))
```

```{r, include=FALSE}
DF_rfreq_non10 <- subset(DF_rfreq, Arrest.Category %in% tmp[-c(1:10)])

ggplot(DF_rfreq_non10, aes(x=Arrest.Year, y=Freq, color=Arrest.Category, group=Arrest.Category)) +
  ggtitle("Figure 12: Line plot of percentage of a crime vs year for other crimes in Fig.11") + xlab("Year") + 
  ylab("Percentage of a crime relative to all crimes") +
  geom_line() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = "none") +
  scale_y_log10() +
  geom_text_repel(
    data = subset(DF_rfreq_non10, Arrest.Year == 2021),
    aes(label = Arrest.Category),
    nudge_x = 30,
    nudge_y = 0.1,
    segment.alpha = 0.3,
    size = 2
  ) +
  lims(x = c(2016, 2022))
```


# Analysis

Since crime is likely to be a rare event, the number of occurrences per day of a given crime is expected to follow Poisson distribution. Poisson distribution is a distribution used to describe the distribution of the number of rare phenomena when a large number of them are observed. If a distribution follows Poisson distribution, and the average number of occurrences of the phenomenon is $\lambda$, the probability that the phenomenon will occur $x$ times is given by
$$p(x) = \exp(-\lambda)\frac{\lambda^{x}}{x!}.$$
In the following, we will estimate $\lambda$ of each crime before and after COVID-19 to see there is a difference in crime trend.

## Offenses Against Family & Children
### Before COVID-19
The trend of "Offenses Against Family & Children," Domestic Violence (DV), appears to have changed after COVID-19. The frequency table of DV before COVID-19 is as follows.

```{r}
DF_WM_16_19 <- DF_WM[DF_WM$Arrest.Year%in%c(2016,2017,2018,2019),]
DF_WM_16_19_DV <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Offenses Against Family & Children',]

# table of date and the number of occurrences
DV_day_16_19 <- sapply(unique(DF_WM_16_19_DV$Arrest.Date),
                       function(x){sum(DF_WM_16_19_DV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(DV_day_16_19)`|`r (365*4+1 - length(DV_day_16_19))/(365*4+1)`|
|1|`r length(DV_day_16_19[DV_day_16_19==1])`|`r length(DV_day_16_19[DV_day_16_19==1])/(365*4+1)`|
|2|`r length(DV_day_16_19[DV_day_16_19==2])`|`r length(DV_day_16_19[DV_day_16_19==2])/(365*4+1)`|
|3|0|0|

We can calculate $\lambda$ from the above table and $\lambda = 0.0678$. We will plot the histogram and Poisson distribution with $\lambda = 0.0678$ to check if they match or not.

```{r, fig.show="hold", out.width="48%"}

x_DV <- 0:5
y_DV <- c(1364,95,2,0,0,0)
fx <- dpois(x=x_DV, lambda=99/(365*4+1))
data_DV <- data.frame(x_DV, y_DV, fx)

ggplot(data_DV, aes(x=x_DV,y=y_DV)) +
  ggtitle("Figure 13: Histogram of DV in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_DV) +
  ggtitle("Figure 14: Relative frequency histogram of DV in 2016 - 2019 \n and Poisson distribution with lambda = 0.0678") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_DV,y=y_DV/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_DV,y=fx), color='red') +
  geom_point(aes(x=x_DV,y=fx), color='red')

```

We can see that the Poisson distribution fits well with the histogram.   
  
Next, we try to estimate $99\%$ Confidence Interval of $\lambda$. The variance of Poisson distribution is equal to its mean ($\lambda$). Therefore, $99\%$ Confidence Interval of $\lambda$ can be written as
$$ \bar{x} - z_{*}\cdot\sqrt{\frac{\bar{x}}{n}} \leq \lambda \leq \bar{x} + z_{*}\cdot\sqrt{\frac{\bar{x}}{n}}, $$
where $\bar{x}$ is the sample mean, $n$ is the sample size, and $z_*$ is z-value corresponding to the $99\%$ confidence interval, and the value is 2.58. From this expression, **99% Confidence Interval of $\lambda$ for DV before COVID-19 is [`r round(99/(365*4+1) - 2.58*(99/(365*4+1)/(356*4+1))**0.5, 4)`, `r round(99/(365*4+1) + 2.58*(99/(365*4+1)/(356*4+1))**0.5, 4)`]**.


### After COVID-19  
The frequency table of DV after COVID-19 is as follows.

```{r}
DF_WM_20_21 <- DF_WM[DF_WM$Arrest.Year%in%c(2020,2021),]
DF_WM_20_21_DV <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Offenses Against Family & Children',]

# table of date and the number of occurrences
DV_day_20_21 <- sapply(unique(DF_WM_20_21_DV$Arrest.Date),
                       function(x){sum(DF_WM_20_21_DV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(DV_day_20_21)`|`r (365*2+1 - length(DV_day_20_21))/(365*2+1)`|
|1|`r length(DV_day_20_21[DV_day_20_21==1])`|`r length(DV_day_20_21[DV_day_20_21==1])/(365*2+1)`|
|2|`r length(DV_day_20_21[DV_day_20_21==2])`|`r length(DV_day_20_21[DV_day_20_21==2])/(365*2+1)`|
|3|0|0|
|4|`r length(DV_day_20_21[DV_day_20_21==4])`|`r length(DV_day_20_21[DV_day_20_21==4])/(365*2+1)`|
|5|0|0|
|...|0|0|
|44|0|0|
|45|`r length(DV_day_20_21[DV_day_20_21==45])`|`r length(DV_day_20_21[DV_day_20_21==45])/(365*2+1)`|
|46|0|0|
|...|0|0|
|77|0|0|
|78|`r length(DV_day_20_21[DV_day_20_21==78])`|`r length(DV_day_20_21[DV_day_20_21==78])/(365*2+1)`|
|79|0|0|
|...|0|0|

There are two outliers (45 and 78) in the table. The dates of them are `r labels(DV_day_20_21[DV_day_20_21==45])` and `r labels(DV_day_20_21[DV_day_20_21==78])`. Since these dates are correspond to "Capitol attack" and "George Floyd protests", we will drop the value of these dates.  
  
The calculated $\lambda = 0.0725$. The histogram and the poisson distribution with $\lambda = 0.0725$ are shown in Figure 16.


```{r, fig.show="hold", out.width="48%"}
x_DV <- 0:5
y_DV <- c(680,47,1,0,1,0)
fx <- dpois(x=x_DV, lambda=53/(365*2+1))
data_DV <- data.frame(x_DV, y_DV, fx)

ggplot(data_DV, aes(x=x_DV,y=y_DV)) +
  ggtitle("Figure 15: Histogram of DV in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_DV) +
  ggtitle("Figure 16: Reralive frequency histogram of DV in 2020 - 2021 \n and Pission distribution with lambda = 0.0725") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_DV,y=y_DV/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_DV,y=fx), color='red') +
  geom_point(aes(x=x_DV,y=fx), color='red')

```

The Poisson distribution fits well with the histogram.

**99% Confidence Interval of $\lambda$ for DV after COVID-19 is [`r round(53/(365*2+1) - 2.58*(53/(365*2+1)/(356*2+1))**0.5, 4)`, `r round(53/(365*2+1) + 2.58*(53/(365*2+1)/(356*2+1))**0.5, 4)`]**.

### Comparing Confidence Intervals

Figure 17 shows the Confidence Intervals before and after COVID-19. **There was overlap in the Confidence Intervals, and it is not possible to say that there was a change in the $\lambda$ of "Offenses Against Family & Children" before or after COVID-19**.

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(99/(365*4+1)-2.58*(99/(365*4+1)/(356*4+1))**0.5, 99/(365*4+1)+ 2.58*(99/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(53/(365*2+1) - 2.58*(53/(365*2+1)/(356*2+1))**0.5, 53/(365*2+1) + 2.58*(53/(365*2+1)/(356*2+1))**0.5)
data_CI_DV <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_DV) +
  ggtitle("Figure 17: 99% Confidence Interval of lambda for DV") + 
  xlab("") +
  ylab("99% Confidence Interval of lambda") + 
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```


## Traffic Violations
### Before COVID-19
The trend of "Traffic Violations" also appears to have changed after COVID-19. The frequency table of Traffic Violations before COVID-19 is as follows.

```{r}
DF_WM_16_19_TV <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Traffic Violations',]

# table of date and the number of occurrences
TV_day_16_19 <- sapply(unique(DF_WM_16_19_TV$Arrest.Date),
                       function(x){sum(DF_WM_16_19_TV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(TV_day_16_19)`|`r (365*4+1 - length(TV_day_16_19))/(365*4)`|
|1|`r length(TV_day_16_19[TV_day_16_19==1])`|`r length(TV_day_16_19[TV_day_16_19==1])/(365*4+1)`|
|2|`r length(TV_day_16_19[TV_day_16_19==2])`|`r length(TV_day_16_19[TV_day_16_19==2])/(365*4+1)`|
|3|`r length(TV_day_16_19[TV_day_16_19==3])`|`r length(TV_day_16_19[TV_day_16_19==3])/(365*4+1)`|
|4|`r length(TV_day_16_19[TV_day_16_19==4])`|`r length(TV_day_16_19[TV_day_16_19==4])/(365*4+1)`|
|5|`r length(TV_day_16_19[TV_day_16_19==5])`|`r length(TV_day_16_19[TV_day_16_19==5])/(365*4+1)`|
|6|`r length(TV_day_16_19[TV_day_16_19==6])`|`r length(TV_day_16_19[TV_day_16_19==6])/(365*4+1)`|
|7|0|0|

The calculated $\lambda = 0.907$. The histogram and the poisson distribution with $\lambda = 0.907$ are shown in Figure 19.

```{r, fig.show="hold", out.width="48%"}

x_TV <- 0:10
y_TV <- c(602,530,225,77,22,4,1,0,0,0,0)
fx <- dpois(x=x_TV, lambda=sum(TV_day_16_19)/(365*4+1))
data_TV <- data.frame(x_TV, y_TV, fx)

ggplot(data_TV, aes(x=x_TV,y=y_TV)) +
  ggtitle("Figure 18: Histogram of traffic violations in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_TV) +
  ggtitle("Figure 19: Relative frequency histogram of traffic violations in 2016 - 2019 \n and Pission distribution with lambda = 0.907") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_TV,y=y_TV/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_TV,y=fx), color="red") +
  geom_point(aes(x=x_TV,y=fx), color='red')

```

The Poisson distribution fits well with the histogram.

**99% Confidence Interval of $\lambda$ for Traffic Violations before COVID-19 is [`r round(sum(TV_day_16_19)/(365*4+1) - 2.58*(sum(TV_day_16_19)/(365*4+1)/(356*4+1))**0.5, 3)`, `r round(sum(TV_day_16_19)/(365*4+1) + 2.58*(sum(TV_day_16_19)/(365*4+1)/(356*4+1))**0.5, 3)`]**.

### After COVID-19  
The frequency table of Traffic Violations after COVID-19 is as follows.

```{r}
DF_WM_20_21_TV <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Traffic Violations',]

# table of date and the number of occurrences
TV_day_20_21 <- sapply(unique(DF_WM_20_21_TV$Arrest.Date),
                       function(x){sum(DF_WM_20_21_TV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(TV_day_20_21)`|`r (365*2+1 - length(TV_day_20_21))/(365*2+1)`|
|1|`r length(TV_day_20_21[TV_day_20_21==1])`|`r length(TV_day_20_21[TV_day_20_21==1])/(365*2+1)`|
|2|`r length(TV_day_20_21[TV_day_20_21==2])`|`r length(TV_day_20_21[TV_day_20_21==2])/(365*2+1)`|
|3|`r length(TV_day_20_21[TV_day_20_21==3])`|`r length(TV_day_20_21[TV_day_20_21==3])/(365*2+1)`|
|4|`r length(TV_day_20_21[TV_day_20_21==4])`|`r length(TV_day_20_21[TV_day_20_21==4])/(365*2+1)`|
|5|0|0|

The calculated $\lambda = 0.306$. The histogram and the poisson distribution with $\lambda = 0.306$ are shown in Figure 21.

```{r, fig.show="hold", out.width="48%"}

x_TV <- 0:10
y_TV <- c(546,156,23,3,3,0,0,0,0,0,0)
fx <- dpois(x=x_TV, lambda=sum(TV_day_20_21)/(365*2+1))
data_TV <- data.frame(x_TV, y_TV, fx)

ggplot(data_TV, aes(x=x_TV,y=y_TV)) +
  ggtitle("Figure 20: Histogram of traffic violations in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_TV) +
  ggtitle("Figure 21: Relative frequency histogram of traffic violations in 2020 - 2021 \n and Pission distribution with lambda = 0.306") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_TV,y=y_TV/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_TV,y=fx), color="red") +
  geom_point(aes(x=x_TV,y=fx), color='red')

```

The Poisson distribution fits well with the histogram.

**99% Confidence Interval of $\lambda$ for Traffic Violations before COVID-19 is [`r round(sum(TV_day_20_21)/(365*2+1) - 2.58*(sum(TV_day_20_21)/(365*2+1)/(356*2+1))**0.5, 3)`, `r round(sum(TV_day_20_21)/(365*2+1) + 2.58*(sum(TV_day_20_21)/(365*2+1)/(356*2+1))**0.5, 3)`]**.

### Comparing Confidence Intervals

Figure 22 shows the Confidence Intervals before and after COVID-19. **There was no overlap in the Confidence Intervals, and there may have been a change in the Traffic Violations lambda before and after COVID-19**.

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(TV_day_16_19)/(365*4+1) - 2.58*(sum(TV_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(TV_day_16_19)/(365*4+1) + 2.58*(sum(TV_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(TV_day_20_21)/(365*2+1) - 2.58*(sum(TV_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(TV_day_20_21)/(365*2+1) + 2.58*(sum(TV_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_TV <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_TV) +
  ggtitle("Figure 22: 99% Confidence Interval of lambda for Traffic Violations") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

## Simple Assault  
### Before COVID-19  
The below table shows the frequency and relative frequency of Simple Assault before COVID-19.

```{r}
DF_WM_16_19_SA <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Simple Assault',]

# table of date and the number of occurrences
SA_day_16_19 <- sapply(unique(DF_WM_16_19_SA$Arrest.Date),
                       function(x){sum(DF_WM_16_19_SA$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(SA_day_16_19)`|`r (365*4+1 - length(SA_day_16_19))/(365*4+1)`|
|1|`r length(SA_day_16_19[SA_day_16_19==1])`|`r length(SA_day_16_19[SA_day_16_19==1])/(365*4+1)`|
|2|`r length(SA_day_16_19[SA_day_16_19==2])`|`r length(SA_day_16_19[SA_day_16_19==2])/(365*4+1)`|
|3|`r length(SA_day_16_19[SA_day_16_19==3])`|`r length(SA_day_16_19[SA_day_16_19==3])/(365*4+1)`|
|4|`r length(SA_day_16_19[SA_day_16_19==4])`|`r length(SA_day_16_19[SA_day_16_19==4])/(365*4+1)`|
|5|`r length(SA_day_16_19[SA_day_16_19==5])`|`r length(SA_day_16_19[SA_day_16_19==5])/(365*4+1)`|
|6|`r length(SA_day_16_19[SA_day_16_19==6])`|`r length(SA_day_16_19[SA_day_16_19==6])/(365*4+1)`|
|7|`r length(SA_day_16_19[SA_day_16_19==7])`|`r length(SA_day_16_19[SA_day_16_19==7])/(365*4+1)`|
|8|`r length(SA_day_16_19[SA_day_16_19==8])`|`r length(SA_day_16_19[SA_day_16_19==8])/(365*4+1)`|
|9|`r length(SA_day_16_19[SA_day_16_19==9])`|`r length(SA_day_16_19[SA_day_16_19==9])/(365*4+1)`|
|10|`r length(SA_day_16_19[SA_day_16_19==10])`|`r length(SA_day_16_19[SA_day_16_19==10])/(365*4+1)`|

We got $\lambda = 1.36$ by calculating the average of occurrences per day.

```{r, fig.show="hold", out.width="48%"}

x_SA <- 0:10
y_SA <- c(438,479,284,156,76,13,8,4,1,2,0)
fx <- dpois(x=x_SA, lambda=sum(SA_day_16_19)/(365*4+1))
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA, aes(x=x_SA,y=y_SA)) +
  ggtitle("Figure 23: Histogram of Simple Assault in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_SA) +
  ggtitle("Figure 24: Relative frequency histogram of Simple Assault in 2016 - 2019 \n and Poisson distribution with lambda = 1.36") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

```
  
### After COVID-19  
The frequency and relative frequency in 2020 and 2021 is shown in below. The $\lambda$ for 2020 and 2021 was $0.923$.
```{r}
DF_WM_20_21_SA <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Simple Assault',]

# table of date and the number of occurrences
SA_day_20_21 <- sapply(unique(DF_WM_20_21_SA$Arrest.Date),
                       function(x){sum(DF_WM_20_21_SA$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(SA_day_20_21)`|`r (365*2+1 - length(SA_day_20_21))/(365*2+1)`|
|1|`r length(SA_day_20_21[SA_day_20_21==1])`|`r length(SA_day_20_21[SA_day_20_21==1])/(365*2+1)`|
|2|`r length(SA_day_20_21[SA_day_20_21==2])`|`r length(SA_day_20_21[SA_day_20_21==2])/(365*2+1)`|
|3|`r length(SA_day_20_21[SA_day_20_21==3])`|`r length(SA_day_20_21[SA_day_20_21==3])/(365*2+1)`|
|4|`r length(SA_day_20_21[SA_day_20_21==4])`|`r length(SA_day_20_21[SA_day_20_21==4])/(365*2+1)`|
|5|`r length(SA_day_20_21[SA_day_20_21==5])`|`r length(SA_day_20_21[SA_day_20_21==5])/(365*2+1)`|
|6|`r length(SA_day_20_21[SA_day_20_21==6])`|`r length(SA_day_20_21[SA_day_20_21==6])/(365*2+1)`|
|7|`r length(SA_day_20_21[SA_day_20_21==7])`|`r length(SA_day_20_21[SA_day_20_21==7])/(365*2+1)`|
|8|`r length(SA_day_20_21[SA_day_20_21==8])`|`r length(SA_day_20_21[SA_day_20_21==8])/(365*2+1)`|
|9|`r length(SA_day_20_21[SA_day_20_21==9])`|`r length(SA_day_20_21[SA_day_20_21==9])/(365*2+1)`|


```{r, fig.show="hold", out.width="48%"}

x_SA <- 0:10
y_SA <- c(297,267,112,43,8,3,0,0,1,0,0)
fx <- dpois(x=x_SA, lambda=sum(SA_day_20_21)/(365*2+1))
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA, aes(x=x_SA,y=y_SA)) +
  ggtitle("Figure 25: Histogram of Simple Assault in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_SA) +
  ggtitle("Figure 25: Relative frequency histogram of Simple Assault in 2020 - 2021 \n and Poisson distribution with lambda = 0.923") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

```
  
### Comparing Confidence Intervals  
Figure 26 shows the Confidence Intervals before and after COVID-19. **There was no overlap in the Confidence Intervals, and there may have been a change in the Simple Assault lambda before and after COVID-19**.
  
```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(SA_day_16_19)/(365*4+1) - 2.58*(sum(SA_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(SA_day_16_19)/(365*4+1) + 2.58*(sum(SA_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(SA_day_20_21)/(365*2+1) - 2.58*(sum(SA_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(SA_day_20_21)/(365*2+1) + 2.58*(sum(SA_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_SA <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_SA) +
  ggtitle("Figure 26: 99% Confidence Interval of lambda for Simple Assault") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

## Theft  
### Before COVID-19  
The frequency and relative frequency in 2016 to 2019 is shown in below. The $\lambda$ before COVID-19 was $0.404$.

```{r}
DF_WM_16_19_T <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Theft',]

# table of date and the number of occurrences
T_day_16_19 <- sapply(unique(DF_WM_16_19_T$Arrest.Date),
                       function(x){sum(DF_WM_16_19_T$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(T_day_16_19)`|`r (365*4+1 - length(T_day_16_19))/(365*4+1)`|
|1|`r length(T_day_16_19[T_day_16_19==1])`|`r length(T_day_16_19[T_day_16_19==1])/(365*4+1)`|
|2|`r length(T_day_16_19[T_day_16_19==2])`|`r length(T_day_16_19[T_day_16_19==2])/(365*4+1)`|
|3|`r length(T_day_16_19[T_day_16_19==3])`|`r length(T_day_16_19[T_day_16_19==3])/(365*4+1)`|
|4|`r length(T_day_16_19[T_day_16_19==4])`|`r length(T_day_16_19[T_day_16_19==4])/(365*4+1)`|
|5|`r length(T_day_16_19[T_day_16_19==5])`|`r length(T_day_16_19[T_day_16_19==5])/(365*4+1)`|

```{r, fig.show="hold", out.width="48%"}

x_T <- 0:5
y_T <- c(973,398,79,10,1,0)
fx <- dpois(x=x_T, lambda=sum(T_day_16_19)/(365*4+1))
data_T <- data.frame(x_T, y_T, fx)

ggplot(data_T, aes(x=x_T,y=y_T)) +
  ggtitle("Figure 27: Histogram of Theft in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_T) +
  ggtitle("Figure 28: Relative frequency histogram of Theft in 2016 - 2019 \n and Poisson distribution with lambda = 0.404") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_T,y=y_T/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_T,y=fx), color='red') +
  geom_point(aes(x=x_T,y=fx), color='red')

```
  
### After COVID-19  
The frequency and relative frequency in 2020 and 2021 are shown in below. The $\lambda$ for 2020 and 2021 was $0.115$.
  
```{r}
DF_WM_20_21_T <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Theft',]

# table of date and the number of occurrences
T_day_20_21 <- sapply(unique(DF_WM_20_21_T$Arrest.Date),
                       function(x){sum(DF_WM_20_21_T$Arrest.Date==x)})
```


| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(T_day_20_21)`|`r (365*2+1 - length(T_day_20_21))/(365*2+1)`|
|1|`r length(T_day_20_21[T_day_20_21==1])`|`r length(T_day_20_21[T_day_20_21==1])/(365*2+1)`|
|2|`r length(T_day_20_21[T_day_20_21==2])`|`r length(T_day_20_21[T_day_20_21==2])/(365*2+1)`|
|3|`r length(T_day_20_21[T_day_20_21==3])`|`r length(T_day_20_21[T_day_20_21==3])/(365*2+1)`|

```{r, fig.show="hold", out.width="48%"}

x_T <- 0:3
y_T <- c(653,72,6,0)
fx <- dpois(x=x_T, lambda=sum(T_day_20_21)/(365*2+1))
data_T <- data.frame(x_T, y_T, fx)

ggplot(data_T, aes(x=x_T,y=y_T)) +
  ggtitle("Figure 29: Histogram of Theft in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_T) +
  ggtitle("Figure 30: Relative frequency histogram of Theft in 2020 - 2021 \n and Poisson distribution with lambda = 0.115") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_T,y=y_T/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_T,y=fx), color='red') +
  geom_point(aes(x=x_T,y=fx), color='red')

```
  
### Comparing Confidence Intervals  
Figure 31 shows the Confidence Intervals before and after COVID-19. **There was no overlap in the Confidence Intervals, and there may have been a change in the Theft lambda before and after COVID-19**.
  
```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(T_day_16_19)/(365*4+1) - 2.58*(sum(T_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(T_day_16_19)/(365*4+1) + 2.58*(sum(T_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(T_day_20_21)/(365*2+1) - 2.58*(sum(T_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(T_day_20_21)/(365*2+1) + 2.58*(sum(T_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_T <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_T) +
  ggtitle("Figure 31: 99% Confidence Interval of lambda for Theft") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

  
# Interpretation  
## Simple Assault and Traffic Violations
Statistically significant reductions in Simple Assault and Traffic Violations were observed for $\lambda$ before and after COVID-19. Since these crimes seem to be more likely to occur the more people are out, it is likely that the restrictions and curbs on going out due to COVID-19 contributed to the decrease in these crimes.  

## Theft
A statistically significant decrease in theft was also observed in $\lambda$ before and after Corona. Considering that thefts are committed against empty homes, the decrease in empty homes due to the curfew restrictions caused by COVID-19 may have contributed to the decrease in thefts.

## Offenses Against Family & Children  
The more time one spends at home due, the more Offenses Against Family & Children are likely to increase. In fact, in terms of the number of cases alone, Offenses Against Family & Children have increased after COVID-19. At first glance, the curfew restrictions caused by COVID-19 seems to be the cause. However, most of these cases were caused by special incidents unrelated to COVID-19, and when these effects were removed, there was no statistically significant difference in the change in Offenses Against Family & Children before and after COVID-19. As for white males in the DC area, Offenses Against Family & Children to the point of arrest does not appear to be affected by the changes in their lives caused by COVID-19.

# check  

```{r, fig.show="hold", out.width="48%"}

# table of date and the number of occurrences
SA_day_16 <- sapply(unique(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2016,]$Arrest.Date),
                    function(x){sum(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2016,]$Arrest.Date==x)})
SA_day_17 <- sapply(unique(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2017,]$Arrest.Date),
                    function(x){sum(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2017,]$Arrest.Date==x)})
SA_day_18 <- sapply(unique(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2018,]$Arrest.Date),
                    function(x){sum(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2018,]$Arrest.Date==x)})
SA_day_19 <- sapply(unique(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2019,]$Arrest.Date),
                    function(x){sum(DF_WM_16_19_SA[DF_WM_16_19_SA$Arrest.Year==2019,]$Arrest.Date==x)})

# 2016
x_SA <- 0:10
y_SA <- c(365+1-length(SA_day_16),length(SA_day_16[SA_day_16==1]),length(SA_day_16[SA_day_16==2]),
          length(SA_day_16[SA_day_16==3]),length(SA_day_16[SA_day_16==4]),
          length(SA_day_16[SA_day_16==5]),length(SA_day_16[SA_day_16==6]),
          length(SA_day_16[SA_day_16==7]),length(SA_day_16[SA_day_16==8]),
          length(SA_day_16[SA_day_16==9]),length(SA_day_16[SA_day_16==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_16)/(365+1))
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2016 
          \n and Poisson distribution with lambda = 1.5") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/(365+1)), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

# 2017
x_SA <- 0:10
y_SA <- c(365-length(SA_day_17),length(SA_day_17[SA_day_17==1]),length(SA_day_17[SA_day_17==2]),
          length(SA_day_17[SA_day_17==3]),length(SA_day_17[SA_day_17==4]),
          length(SA_day_17[SA_day_17==5]),length(SA_day_17[SA_day_17==6]),
          length(SA_day_17[SA_day_17==7]),length(SA_day_17[SA_day_17==8]),
          length(SA_day_17[SA_day_17==9]),length(SA_day_17[SA_day_17==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_17)/365)
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2017 
          \n and Poisson distribution with lambda = 1.33") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/365), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

# 2018
x_SA <- 0:10
y_SA <- c(365-length(SA_day_18),length(SA_day_18[SA_day_18==1]),length(SA_day_18[SA_day_18==2]),
          length(SA_day_18[SA_day_18==3]),length(SA_day_18[SA_day_18==4]),
          length(SA_day_18[SA_day_18==5]),length(SA_day_18[SA_day_18==6]),
          length(SA_day_18[SA_day_18==7]),length(SA_day_18[SA_day_18==8]),
          length(SA_day_18[SA_day_18==9]),length(SA_day_18[SA_day_18==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_18)/365)
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2018 
          \n and Poisson distribution with lambda = 1.32") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/365), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

# 2019
x_SA <- 0:10
y_SA <- c(365-length(SA_day_19),length(SA_day_19[SA_day_19==1]),length(SA_day_19[SA_day_19==2]),
          length(SA_day_19[SA_day_19==3]),length(SA_day_19[SA_day_19==4]),
          length(SA_day_19[SA_day_19==5]),length(SA_day_19[SA_day_19==6]),
          length(SA_day_19[SA_day_19==7]),length(SA_day_19[SA_day_19==8]),
          length(SA_day_19[SA_day_19==9]),length(SA_day_19[SA_day_19==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_19)/365)
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2019 
          \n and Poisson distribution with lambda = 1.3") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/365), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

```


```{r, fig.show="hold", out.width="48%"}

# table of date and the number of occurrences
SA_day_20 <- sapply(unique(DF_WM_20_21_SA[DF_WM_20_21_SA$Arrest.Year==2020,]$Arrest.Date),
                    function(x){sum(DF_WM_20_21_SA[DF_WM_20_21_SA$Arrest.Year==2020,]$Arrest.Date==x)})
SA_day_21 <- sapply(unique(DF_WM_20_21_SA[DF_WM_20_21_SA$Arrest.Year==2021,]$Arrest.Date),
                    function(x){sum(DF_WM_20_21_SA[DF_WM_20_21_SA$Arrest.Year==2021,]$Arrest.Date==x)})
# 2020
x_SA <- 0:10
y_SA <- c(365+1-length(SA_day_20),length(SA_day_20[SA_day_20==1]),length(SA_day_20[SA_day_20==2]),
          length(SA_day_20[SA_day_20==3]),length(SA_day_20[SA_day_20==4]),
          length(SA_day_20[SA_day_20==5]),length(SA_day_20[SA_day_20==6]),
          length(SA_day_20[SA_day_20==7]),length(SA_day_20[SA_day_20==8]),
          length(SA_day_20[SA_day_20==9]),length(SA_day_20[SA_day_20==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_20)/(365+1))
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2020 
          \n and Poisson distribution with lambda = 0.954") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/(365+1)), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')

# 2021
x_SA <- 0:10
y_SA <- c(365-length(SA_day_21),length(SA_day_21[SA_day_21==1]),length(SA_day_21[SA_day_21==2]),
          length(SA_day_21[SA_day_21==3]),length(SA_day_21[SA_day_21==4]),
          length(SA_day_21[SA_day_21==5]),length(SA_day_21[SA_day_21==6]),
          length(SA_day_21[SA_day_21==7]),length(SA_day_21[SA_day_21==8]),
          length(SA_day_21[SA_day_21==9]),length(SA_day_21[SA_day_21==10]))
fx <- dpois(x=x_SA, lambda=sum(SA_day_21)/365)
data_SA <- data.frame(x_SA, y_SA, fx)

ggplot(data_SA) +
  ggtitle("Figure: Relative frequency histogram of Simple Assault in 2021 
          \n and Poisson distribution with lambda = 0.893") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_SA,y=y_SA/365), stat = "identity") +
  geom_line(aes(x=x_SA,y=fx), color='red') +
  geom_point(aes(x=x_SA,y=fx), color='red')


```



```{r}

x <- c('2016','2017','2018','2019','2020','2021')
interval_2016 <- c(sum(SA_day_16)/(365+1) - 2.58*(sum(SA_day_16)/(365+1)/(356+1))**0.5,
                   sum(SA_day_16)/(365+1) + 2.58*(sum(SA_day_16)/(365+1)/(356+1))**0.5)
interval_2017 <- c(sum(SA_day_17)/(365) - 2.58*(sum(SA_day_17)/(365)/(356))**0.5,
                   sum(SA_day_17)/(365) + 2.58*(sum(SA_day_17)/(365)/(356))**0.5)
interval_2018 <- c(sum(SA_day_18)/(365) - 2.58*(sum(SA_day_18)/(365)/(356))**0.5,
                   sum(SA_day_18)/(365) + 2.58*(sum(SA_day_18)/(365)/(356))**0.5)
interval_2019 <- c(sum(SA_day_19)/(365) - 2.58*(sum(SA_day_19)/(365)/(356))**0.5,
                   sum(SA_day_19)/(365) + 2.58*(sum(SA_day_19)/(365)/(356))**0.5)
interval_2020 <- c(sum(SA_day_20)/(365+1) - 2.58*(sum(SA_day_20)/(365+1)/(356+1))**0.5,
                   sum(SA_day_20)/(365+1) + 2.58*(sum(SA_day_20)/(365+1)/(356+1))**0.5)
interval_2021 <- c(sum(SA_day_21)/(365) - 2.58*(sum(SA_day_21)/(365)/(356))**0.5,
                   sum(SA_day_21)/(365) + 2.58*(sum(SA_day_21)/(365)/(356))**0.5)
data_CI_SA <- data.frame(x,interval_2016,interval_2017,interval_2018,interval_2019,interval_2020,interval_2021)

ggplot(data_CI_SA) +
  ggtitle("Figure: 99% Confidence Interval of lambda for Simple Assault") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=interval_2016[1], ymax=interval_2016[2])) +
  geom_linerange(aes(x=x[2], ymin=interval_2017[1], ymax=interval_2017[2])) +
  geom_linerange(aes(x=x[3], ymin=interval_2018[1], ymax=interval_2018[2])) +
  geom_linerange(aes(x=x[4], ymin=interval_2019[1], ymax=interval_2019[2])) +
  geom_linerange(aes(x=x[5], ymin=interval_2020[1], ymax=interval_2020[2])) +
  geom_linerange(aes(x=x[6], ymin=interval_2021[1], ymax=interval_2021[2]))
  

```


```{r, results="hide"}
mean16 = sum(SA_day_16)/(365+1)
mean17 = sum(SA_day_17)/(365)
mean18 = sum(SA_day_18)/(365)
mean19 = sum(SA_day_19)/(365)
mean20 = sum(SA_day_20)/(365+1)
mean21 = sum(SA_day_21)/(365)

var16 = (((0-mean16)**2)*(366 - length(SA_day_16)) + ((1-mean16)**2)*length(SA_day_16[SA_day_16==1]) +
   ((2-mean16)**2)*length(SA_day_16[SA_day_16==2]) + ((3-mean16)**2)*length(SA_day_16[SA_day_16==3]) +
   ((4-mean16)**2)*length(SA_day_16[SA_day_16==4]) + ((5-mean16)**2)*length(SA_day_16[SA_day_16==5]) +
   ((6-mean16)**2)*length(SA_day_16[SA_day_16==6]) + ((7-mean16)**2)*length(SA_day_16[SA_day_16==7]) +
   ((8-mean16)**2)*length(SA_day_16[SA_day_16==8]) + ((9-mean16)**2)*length(SA_day_16[SA_day_16==9]))/365

var17 = (((0-mean17)**2)*(365 - length(SA_day_17)) + ((1-mean17)**2)*length(SA_day_17[SA_day_17==1]) +
   ((2-mean17)**2)*length(SA_day_17[SA_day_17==2]) + ((3-mean17)**2)*length(SA_day_17[SA_day_17==3]) +
   ((4-mean17)**2)*length(SA_day_17[SA_day_17==4]) + ((5-mean17)**2)*length(SA_day_17[SA_day_17==5]) +
   ((6-mean17)**2)*length(SA_day_17[SA_day_17==6]) + ((7-mean17)**2)*length(SA_day_17[SA_day_17==7]) +
   ((8-mean17)**2)*length(SA_day_17[SA_day_17==8]) + ((9-mean17)**2)*length(SA_day_17[SA_day_17==9]))/364

var18 = (((0-mean18)**2)*(366 - length(SA_day_18)) + ((1-mean18)**2)*length(SA_day_18[SA_day_18==1]) +
   ((2-mean18)**2)*length(SA_day_18[SA_day_18==2]) + ((3-mean18)**2)*length(SA_day_18[SA_day_18==3]) +
   ((4-mean18)**2)*length(SA_day_18[SA_day_18==4]) + ((5-mean18)**2)*length(SA_day_18[SA_day_18==5]) +
   ((6-mean18)**2)*length(SA_day_18[SA_day_18==6]) + ((7-mean18)**2)*length(SA_day_18[SA_day_18==7]) +
   ((8-mean18)**2)*length(SA_day_18[SA_day_18==8]) + ((9-mean18)**2)*length(SA_day_18[SA_day_18==9]))/364

var19 = (((0-mean19)**2)*(366 - length(SA_day_19)) + ((1-mean19)**2)*length(SA_day_19[SA_day_19==1]) +
   ((2-mean19)**2)*length(SA_day_19[SA_day_19==2]) + ((3-mean19)**2)*length(SA_day_19[SA_day_19==3]) +
   ((4-mean19)**2)*length(SA_day_19[SA_day_19==4]) + ((5-mean19)**2)*length(SA_day_19[SA_day_19==5]) +
   ((6-mean19)**2)*length(SA_day_19[SA_day_19==6]) + ((7-mean19)**2)*length(SA_day_19[SA_day_19==7]) +
   ((8-mean19)**2)*length(SA_day_19[SA_day_19==8]) + ((9-mean19)**2)*length(SA_day_19[SA_day_19==9]))/364

var20 = (((0-mean20)**2)*(366 - length(SA_day_20)) + ((1-mean20)**2)*length(SA_day_20[SA_day_20==1]) +
   ((2-mean20)**2)*length(SA_day_16[SA_day_20==2]) + ((3-mean20)**2)*length(SA_day_20[SA_day_20==3]) +
   ((4-mean20)**2)*length(SA_day_16[SA_day_20==4]) + ((5-mean20)**2)*length(SA_day_20[SA_day_20==5]) +
   ((6-mean20)**2)*length(SA_day_16[SA_day_20==6]) + ((7-mean20)**2)*length(SA_day_20[SA_day_20==7]) +
   ((8-mean20)**2)*length(SA_day_16[SA_day_20==8]) + ((9-mean20)**2)*length(SA_day_20[SA_day_20==9]))/365

var21 = (((0-mean21)**2)*(366 - length(SA_day_21)) + ((1-mean21)**2)*length(SA_day_21[SA_day_21==1]) +
   ((2-mean21)**2)*length(SA_day_21[SA_day_21==2]) + ((3-mean21)**2)*length(SA_day_21[SA_day_21==3]) +
   ((4-mean21)**2)*length(SA_day_21[SA_day_21==4]) + ((5-mean21)**2)*length(SA_day_21[SA_day_21==5]) +
   ((6-mean21)**2)*length(SA_day_21[SA_day_21==6]) + ((7-mean21)**2)*length(SA_day_21[SA_day_21==7]) +
   ((8-mean21)**2)*length(SA_day_21[SA_day_21==8]) + ((9-mean21)**2)*length(SA_day_21[SA_day_21==9]))/364

print('The mean and variance of SA in 2016 are ')
mean16
var16
print('The mean and variance of SA in 2017 are ')
mean17
var17
print('The mean and variance of SA in 2018 are ')
mean18
var18
print('The mean and variance of SA in 2019 are ')
mean19
var19
print('The mean and variance of SA in 2020 are ')
mean20
var20
print('The mean and variance of SA in 2021 are ')
mean21
var21
```

# Other crimes
## Release Violations/Fugitive  

```{r}
DF_WM_16_19_RV <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Release Violations/Fugitive',]

# table of date and the number of occurrences
RV_day_16_19 <- sapply(unique(DF_WM_16_19_RV$Arrest.Date),
                       function(x){sum(DF_WM_16_19_RV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(RV_day_16_19)`|`r (365*4+1 - length(RV_day_16_19))/(365*4+1)`|
|1|`r length(RV_day_16_19[RV_day_16_19==1])`|`r length(RV_day_16_19[RV_day_16_19==1])/(365*4+1)`|
|2|`r length(RV_day_16_19[RV_day_16_19==2])`|`r length(RV_day_16_19[RV_day_16_19==2])/(365*4+1)`|
|3|`r length(RV_day_16_19[RV_day_16_19==3])`|`r length(RV_day_16_19[RV_day_16_19==3])/(365*4+1)`|
|4|`r length(RV_day_16_19[RV_day_16_19==4])`|`r length(RV_day_16_19[RV_day_16_19==4])/(365*4+1)`|
|5|`r length(RV_day_16_19[RV_day_16_19==5])`|`r length(RV_day_16_19[RV_day_16_19==5])/(365*4+1)`|
|6|`r length(RV_day_16_19[RV_day_16_19==6])`|`r length(RV_day_16_19[RV_day_16_19==6])/(365*4+1)`|

```{r, fig.show="hold", out.width="48%"}

x_RV <- 0:6
y_RV <- c(817,428,168,40,5,3,0)
fx <- dpois(x=x_RV, lambda=sum(RV_day_16_19)/(365*4+1))
data_RV <- data.frame(x_RV, y_RV, fx)

ggplot(data_RV, aes(x=x_RV,y=y_RV)) +
  ggtitle("Figure : Histogram of Release Violations/Fugitive in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_RV) +
  ggtitle("Figure : Relative frequency histogram of Release Violations/Fugitive in 2016 - 2019 \n and Poisson distribution with lambda = 0.629") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_RV,y=y_RV/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_RV,y=fx), color='red') +
  geom_point(aes(x=x_RV,y=fx), color='red')

```

```{r}
DF_WM_20_21_RV <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Release Violations/Fugitive',]

# table of date and the number of occurrences
RV_day_20_21 <- sapply(unique(DF_WM_20_21_RV$Arrest.Date),
                       function(x){sum(DF_WM_20_21_RV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(RV_day_20_21)`|`r (365*2+1 - length(RV_day_20_21))/(365*2+1)`|
|1|`r length(RV_day_20_21[RV_day_20_21==1])`|`r length(RV_day_20_21[RV_day_20_21==1])/(365*2+1)`|
|2|`r length(RV_day_20_21[RV_day_20_21==2])`|`r length(RV_day_20_21[RV_day_20_21==2])/(365*2+1)`|
|3|`r length(RV_day_20_21[RV_day_20_21==3])`|`r length(RV_day_20_21[RV_day_20_21==3])/(365*2+1)`|
|4|`r length(RV_day_20_21[RV_day_20_21==4])`|`r length(RV_day_20_21[RV_day_20_21==4])/(365*2+1)`|

```{r, fig.show="hold", out.width="48%"}

x_RV <- 0:4
y_RV <- c(549,154,24,4,0)
fx <- dpois(x=x_RV, lambda=sum(RV_day_20_21)/(365*2+1))
data_RV <- data.frame(x_RV, y_RV, fx)

ggplot(data_RV, aes(x=x_RV,y=y_RV)) +
  ggtitle("Figure : Histogram of Release Violations/Fugitive in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_RV) +
  ggtitle("Figure : Relative frequency histogram of Release Violations/Fugitive in 2020 - 2021 \n and Poisson distribution with lambda = 0.293") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_RV,y=y_RV/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_RV,y=fx), color='red') +
  geom_point(aes(x=x_RV,y=fx), color='red')

```

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(RV_day_16_19)/(365*4+1) - 2.58*(sum(RV_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(RV_day_16_19)/(365*4+1) + 2.58*(sum(RV_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(RV_day_20_21)/(365*2+1) - 2.58*(sum(RV_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(RV_day_20_21)/(365*2+1) + 2.58*(sum(RV_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_RV <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_RV) +
  ggtitle("Figure : 99% Confidence Interval of lambda for Release Violations/Fugitive") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

## Driving/Boating While Intoxicated

```{r}
DF_WM_16_19_DI <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Driving/Boating While Intoxicated',]

# table of date and the number of occurrences
DI_day_16_19 <- sapply(unique(DF_WM_16_19_DI$Arrest.Date),
                       function(x){sum(DF_WM_16_19_DI$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(DI_day_16_19)`|`r (365*4+1 - length(DI_day_16_19))/(365*4+1)`|
|1|`r length(DI_day_16_19[DI_day_16_19==1])`|`r length(DI_day_16_19[DI_day_16_19==1])/(365*4+1)`|
|2|`r length(DI_day_16_19[DI_day_16_19==2])`|`r length(DI_day_16_19[DI_day_16_19==2])/(365*4+1)`|
|3|`r length(DI_day_16_19[DI_day_16_19==3])`|`r length(DI_day_16_19[DI_day_16_19==3])/(365*4+1)`|
|4|`r length(DI_day_16_19[DI_day_16_19==4])`|`r length(DI_day_16_19[DI_day_16_19==4])/(365*4+1)`|
|5|`r length(DI_day_16_19[DI_day_16_19==5])`|`r length(DI_day_16_19[DI_day_16_19==5])/(365*4+1)`|
|6|`r length(DI_day_16_19[DI_day_16_19==6])`|`r length(DI_day_16_19[DI_day_16_19==6])/(365*4+1)`|
  
  
```{r, fig.show="hold", out.width="48%"}

x_DI <- 0:6
y_DI <- c(875,416,138,25,6,1,0)
fx <- dpois(x=x_DI, lambda=sum(DI_day_16_19)/(365*4+1))
data_DI <- data.frame(x_DI, y_DI, fx)

ggplot(data_DI, aes(x=x_DI,y=y_DI)) +
  ggtitle("Figure : Histogram of Driving/Boating While Intoxicated in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_DI) +
  ggtitle("Figure : Relative frequency histogram of Driving/Boating While Intoxicated in 2016 - 2019 \n and Poisson distribution with lambda = 0.545") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_DI,y=y_DI/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_DI,y=fx), color='red') +
  geom_point(aes(x=x_DI,y=fx), color='red')

```
  
  
```{r}
DF_WM_20_21_DI <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Driving/Boating While Intoxicated',]

# table of date and the number of occurrences
DI_day_20_21 <- sapply(unique(DF_WM_20_21_DI$Arrest.Date),
                       function(x){sum(DF_WM_20_21_DI$Arrest.Date==x)})
```


| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(DI_day_20_21)`|`r (365*2+1 - length(DI_day_20_21))/(365*2+1)`|
|1|`r length(DI_day_20_21[DI_day_20_21==1])`|`r length(DI_day_20_21[DI_day_20_21==1])/(365*2+1)`|
|2|`r length(DI_day_20_21[DI_day_20_21==2])`|`r length(DI_day_20_21[DI_day_20_21==2])/(365*2+1)`|
|3|`r length(DI_day_20_21[DI_day_20_21==3])`|`r length(DI_day_20_21[DI_day_20_21==3])/(365*2+1)`|
|4|`r length(DI_day_20_21[DI_day_20_21==4])`|`r length(DI_day_20_21[DI_day_20_21==4])/(365*2+1)`|
|5|`r length(DI_day_20_21[DI_day_20_21==5])`|`r length(DI_day_20_21[DI_day_20_21==5])/(365*2+1)`|


```{r, fig.show="hold", out.width="48%"}

x_DI <- 0:5
y_DI <- c(527,168,29,5,2,0)
fx <- dpois(x=x_DI, lambda=sum(DI_day_20_21)/(365*2+1))
data_DI <- data.frame(x_DI, y_DI, fx)

ggplot(data_DI, aes(x=x_DI,y=y_DI)) +
  ggtitle("Figure : Histogram of Driving/Boating While Intoxicated in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_DI) +
  ggtitle("Figure : Relative frequency histogram of Driving/Boating While Intoxicated in 2020 - 2021 \n and Poisson distribution with lambda = 0.341") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_DI,y=y_DI/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_DI,y=fx), color='red') +
  geom_point(aes(x=x_DI,y=fx), color='red')

```

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(DI_day_16_19)/(365*4+1) - 2.58*(sum(DI_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(DI_day_16_19)/(365*4+1) + 2.58*(sum(DI_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(DI_day_20_21)/(365*2+1) - 2.58*(sum(DI_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(DI_day_20_21)/(365*2+1) + 2.58*(sum(DI_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_DI <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_DI) +
  ggtitle("Figure : 99% Confidence Interval of lambda for Driving/Boating While Intoxicated") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

## Narcotics

```{r}
DF_WM_16_19_N <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Narcotics',]

# table of date and the number of occurrences
N_day_16_19 <- sapply(unique(DF_WM_16_19_N$Arrest.Date),
                       function(x){sum(DF_WM_16_19_N$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(N_day_16_19)`|`r (365*4+1 - length(N_day_16_19))/(365*4+1)`|
|1|`r length(N_day_16_19[N_day_16_19==1])`|`r length(N_day_16_19[N_day_16_19==1])/(365*4+1)`|
|2|`r length(N_day_16_19[N_day_16_19==2])`|`r length(N_day_16_19[N_day_16_19==2])/(365*4+1)`|
|3|`r length(N_day_16_19[N_day_16_19==3])`|`r length(N_day_16_19[N_day_16_19==3])/(365*4+1)`|
|4|`r length(N_day_16_19[N_day_16_19==4])`|`r length(N_day_16_19[N_day_16_19==4])/(365*4+1)`|
|5|`r length(N_day_16_19[N_day_16_19==5])`|`r length(N_day_16_19[N_day_16_19==5])/(365*4+1)`|
|6|`r length(N_day_16_19[N_day_16_19==6])`|`r length(N_day_16_19[N_day_16_19==6])/(365*4+1)`|
|7|`r length(N_day_16_19[N_day_16_19==7])`|`r length(N_day_16_19[N_day_16_19==7])/(365*4+1)`|
|8|`r length(N_day_16_19[N_day_16_19==8])`|`r length(N_day_16_19[N_day_16_19==8])/(365*4+1)`|
|9|`r length(N_day_16_19[N_day_16_19==9])`|`r length(N_day_16_19[N_day_16_19==9])/(365*4+1)`|
|10|`r length(N_day_16_19[N_day_16_19==10])`|`r length(N_day_16_19[N_day_16_19==10])/(365*4+1)`|
|11|`r length(N_day_16_19[N_day_16_19==11])`|`r length(N_day_16_19[N_day_16_19==11])/(365*4+1)`|
|12|`r length(N_day_16_19[N_day_16_19==12])`|`r length(N_day_16_19[N_day_16_19==12])/(365*4+1)`|
|13|`r length(N_day_16_19[N_day_16_19==13])`|`r length(N_day_16_19[N_day_16_19==13])/(365*4+1)`|
|14|`r length(N_day_16_19[N_day_16_19==14])`|`r length(N_day_16_19[N_day_16_19==14])/(365*4+1)`|

```{r, fig.show="hold", out.width="48%"}

x_N <- 0:14
y_N <- c(1053,318,66,10,5,6,0,1,0,1,0,0,0,1,0)
fx <- dpois(x=x_N, lambda=sum(N_day_16_19)/(365*4+1))
data_N <- data.frame(x_N, y_N, fx)

ggplot(data_N, aes(x=x_N,y=y_N)) +
  ggtitle("Figure : Histogram of Narcotics in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_N) +
  ggtitle("Figure : Relative frequency histogram of Narcotics in 2016 - 2019 \n and Poisson distribution with lambda = 0.383") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_N,y=y_N/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_N,y=fx), color='red') +
  geom_point(aes(x=x_N,y=fx), color='red')

```

```{r}
DF_WM_20_21_N <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Narcotics',]

# table of date and the number of occurrences
N_day_20_21 <- sapply(unique(DF_WM_20_21_N$Arrest.Date),
                       function(x){sum(DF_WM_20_21_N$Arrest.Date==x)})
```


| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(N_day_20_21)`|`r (365*2+1 - length(N_day_20_21))/(365*2+1)`|
|1|`r length(N_day_20_21[N_day_20_21==1])`|`r length(N_day_20_21[N_day_20_21==1])/(365*2+1)`|
|2|`r length(N_day_20_21[N_day_20_21==2])`|`r length(N_day_20_21[N_day_20_21==2])/(365*2+1)`|
|3|`r length(N_day_20_21[N_day_20_21==3])`|`r length(N_day_20_21[N_day_20_21==3])/(365*2+1)`|
|4|`r length(N_day_20_21[N_day_20_21==4])`|`r length(N_day_20_21[N_day_20_21==4])/(365*2+1)`|


```{r, fig.show="hold", out.width="48%"}

x_N <- 0:4
y_N <- c(652,66,10,3,0)
fx <- dpois(x=x_N, lambda=sum(N_day_20_21)/(365*2+1))
data_N <- data.frame(x_N, y_N, fx)

ggplot(data_N, aes(x=x_N,y=y_N)) +
  ggtitle("Figure : Histogram of Narcotics in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_N) +
  ggtitle("Figure : Relative frequency histogram of Narcotics in 2020 - 2021 \n and Poisson distribution with lambda = 0.13") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_N,y=y_N/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_N,y=fx), color='red') +
  geom_point(aes(x=x_N,y=fx), color='red')

```

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(N_day_16_19)/(365*4+1) - 2.58*(sum(N_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(N_day_16_19)/(365*4+1) + 2.58*(sum(N_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(N_day_20_21)/(365*2+1) - 2.58*(sum(N_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(N_day_20_21)/(365*2+1) + 2.58*(sum(N_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_N <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_N) +
  ggtitle("Figure : 99% Confidence Interval of lambda for Narcotics") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```

## Liquor Law Violations

```{r}
DF_WM_16_19_LV <- DF_WM_16_19[DF_WM_16_19$Arrest.Category=='Liquor Law Violations',]

# table of date and the number of occurrences
LV_day_16_19 <- sapply(unique(DF_WM_16_19_LV$Arrest.Date),
                       function(x){sum(DF_WM_16_19_LV$Arrest.Date==x)})
```

| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*4+1 - length(LV_day_16_19)`|`r (365*4+1 - length(LV_day_16_19))/(365*4+1)`|
|1|`r length(LV_day_16_19[LV_day_16_19==1])`|`r length(LV_day_16_19[LV_day_16_19==1])/(365*4+1)`|
|2|`r length(LV_day_16_19[LV_day_16_19==2])`|`r length(LV_day_16_19[LV_day_16_19==2])/(365*4+1)`|
|3|`r length(LV_day_16_19[LV_day_16_19==3])`|`r length(LV_day_16_19[LV_day_16_19==3])/(365*4+1)`|
|4|`r length(LV_day_16_19[LV_day_16_19==4])`|`r length(LV_day_16_19[LV_day_16_19==4])/(365*4+1)`|
|5|`r length(LV_day_16_19[LV_day_16_19==5])`|`r length(LV_day_16_19[LV_day_16_19==5])/(365*4+1)`|
|6|`r length(LV_day_16_19[LV_day_16_19==6])`|`r length(LV_day_16_19[LV_day_16_19==6])/(365*4+1)`|

```{r, fig.show="hold", out.width="48%"}

x_LV <- 0:6
y_LV <- c(1090,259,76,32,3,1,0)
fx <- dpois(x=x_LV, lambda=sum(LV_day_16_19)/(365*4+1))
data_LV <- data.frame(x_LV, y_LV, fx)

ggplot(data_LV, aes(x=x_LV,y=y_LV)) +
  ggtitle("Figure : Histogram of Liquor Law Violations in 2016 - 2019") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_LV) +
  ggtitle("Figure : Relative frequency histogram of Liquor Law Violations in 2016 - 2019 \n and Poisson distribution with lambda = 0.359") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_LV,y=y_LV/(365*4+1)), stat = "identity") +
  geom_line(aes(x=x_LV,y=fx), color='red') +
  geom_point(aes(x=x_LV,y=fx), color='red')

```

```{r}
DF_WM_20_21_LV <- DF_WM_20_21[DF_WM_20_21$Arrest.Category=='Liquor Law Violations',]

# table of date and the number of occurrences
LV_day_20_21 <- sapply(unique(DF_WM_20_21_LV$Arrest.Date),
                       function(x){sum(DF_WM_20_21_LV$Arrest.Date==x)})
```


| # of occurrences per day | Frequency | Relative frequency |
|:------------------------:|:---------:|:------------------:|
|0|`r 365*2+1 - length(LV_day_20_21)`|`r (365*2+1 - length(LV_day_20_21))/(365*2+1)`|
|1|`r length(LV_day_20_21[LV_day_20_21==1])`|`r length(LV_day_20_21[LV_day_20_21==1])/(365*2+1)`|
|2|`r length(LV_day_20_21[LV_day_20_21==2])`|`r length(LV_day_20_21[LV_day_20_21==2])/(365*2+1)`|
|3|`r length(LV_day_20_21[LV_day_20_21==3])`|`r length(LV_day_20_21[LV_day_20_21==3])/(365*2+1)`|
|4|`r length(LV_day_20_21[LV_day_20_21==4])`|`r length(LV_day_20_21[LV_day_20_21==4])/(365*2+1)`|


```{r, fig.show="hold", out.width="48%"}

x_LV <- 0:4
y_LV <- c(699,27,4,1,0)
fx <- dpois(x=x_LV, lambda=sum(LV_day_20_21)/(365*2+1))
data_LV <- data.frame(x_LV, y_LV, fx)

ggplot(data_LV, aes(x=x_LV,y=y_LV)) +
  ggtitle("Figure : Histogram of Liquor Law Violations in 2020 - 2021") + 
  xlab("Number of occurrences per day") + 
  ylab("Frequency") +
  geom_bar(stat = "identity") 

ggplot(data_LV) +
  ggtitle("Figure : Relative frequency histogram of Liquor Law Violations in 2020 - 2021 \n and Poisson distribution with lambda = 0.052") + 
  xlab("Number of occurrences per day") + 
  ylab("Relative frequency") +
  geom_bar(aes(x=x_LV,y=y_LV/(365*2+1)), stat = "identity") +
  geom_line(aes(x=x_LV,y=fx), color='red') +
  geom_point(aes(x=x_LV,y=fx), color='red')

```

```{r}

x <- c('Before COVID-19','After COVID-19')
pre_covid_interval <- c(sum(LV_day_16_19)/(365*4+1) - 2.58*(sum(LV_day_16_19)/(365*4+1)/(356*4+1))**0.5,
                        sum(LV_day_16_19)/(365*4+1) + 2.58*(sum(LV_day_16_19)/(365*4+1)/(356*4+1))**0.5)
post_covid_interval <- c(sum(LV_day_20_21)/(365*2+1) - 2.58*(sum(LV_day_20_21)/(365*2+1)/(356*2+1))**0.5,
                         sum(LV_day_20_21)/(365*2+1) + 2.58*(sum(LV_day_20_21)/(365*2+1)/(356*2+1))**0.5)
data_CI_LV <- data.frame(x,pre_covid_interval,post_covid_interval)

ggplot(data_CI_LV) +
  ggtitle("Figure : 99% Confidence Interval of lambda for Liquor Law Violations") + 
  ylab("99% Confidence Interval of lambda") + 
  xlab("") +
  coord_flip() +
  geom_linerange(aes(x=x[1], ymin=pre_covid_interval[1], ymax=pre_covid_interval[2])) +
  geom_linerange(aes(x=x[2], ymin=post_covid_interval[1], ymax=post_covid_interval[2]))
  

```




